---
title: CVE-2010-2553 分析
date: 2018-05-04 07:55:37
categories:
tags:
	- 《漏洞战争》
	- CVE

---


## 环境

XP sp3

Windows Media Player 10.00.00.4063



## 漏洞分析

[exploit-db 上的 POC](CVE-2010-2553-POC.py)

运行生成的 poc.avi 发现直接崩溃。

运行 `Windows Media Player `  使用 Windbg 附加进程， 然后开`!gflag +hpa`  启动页堆 (gflag.exe开启页堆)。

(开启时发现没有符号表，配置远程符号表不能下载，我复制了之前win7上的到XP然后windbg配置路径，ok)

> 页堆：堆管理器会在堆块中添加不可访问的栅栏，当溢出覆盖栅栏页时立即出发异常

![img-1](CVE-2010-2553/img-1.png)

继续执行 ， 程序崩溃。


![img-2](CVE-2010-2553/img-2.png)

栈回溯，找到溢出函数，


![img-3](CVE-2010-2553/img-3.png)

`!address edi`  查看rdi和rdi-0x1000地址的属性。异常的原因是非法往不可写地址写入数据。


![img-4](CVE-2010-2553/img-4.png)

我们对地址`0x73b7cbee` 下断点，失败了， 因为`iccvid` 只有在解析poc.avi时才会动态加载。

使用 `sxe ld:iccvid` ，在首次加载 iccvid 时断下，然后对 `0x73b7cbee`下断点。

我们用IDA静态分析，Windbg动态分析 溢出函数：

分析过程书中已经详尽。

## 参考

https://cartermgj.github.io/2016/04/20/CVE-2010-2553/

http://weaponx.site/2017/05/23/CVE-2010-2553%E5%88%86%E6%9E%90-%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89/

http://www.wooy0ung.me/exploit/2017/09/30/cve-2010-2553/

https://cartermgj.github.io/2016/04/20/CVE-2010-2553/

https://paper.tuisec.win/detail/8763ec48975e0b8

http://3xp10it.cc/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/17/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2010-2553/

http://www.cnblogs.com/Ox9A82/p/5715673.html

http://www.freebuf.com/column/155415.html

https://paper.tuisec.win/detail/8763ec48975e0b8

http://www.echojb.com/dotnet-report/2016/12/02/275619.html























